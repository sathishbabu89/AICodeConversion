IDENTIFICATION DIVISION.
PROGRAM-ID. VSAMREAD.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT CUST-FILE ASSIGN TO 'CUSTOMERS.VSAM'
        ORGANIZATION IS INDEXED
        ACCESS MODE IS RANDOM
        RECORD KEY IS CUST-ID
        FILE STATUS IS WS-FILE-STATUS.

DATA DIVISION.
FILE SECTION.
FD  CUST-FILE.
01  CUSTOMER-RECORD.
    05  CUST-ID        PIC 9(5).
    05  CUST-NAME      PIC X(30).

WORKING-STORAGE SECTION.
01  WS-FILE-STATUS    PIC X(2).
01  WS-CUST-ID        PIC 9(5).

PROCEDURE DIVISION.
    DISPLAY "Enter Customer ID: ".
    ACCEPT WS-CUST-ID.

    READ CUST-FILE KEY IS WS-CUST-ID.

    IF WS-FILE-STATUS = "00" THEN
        DISPLAY "Customer Name: " CUST-NAME
    ELSE
        DISPLAY "Record Not Found"
    END-IF.

    STOP RUN.
